> Struts拦截器的最大特点是它的透明性
> 以前核心是filterdispatcher

#### 工作原理
1. StrutsPrepareAndExecuteFilter(Struts2中央控制器)实例化一个action代理类actionProxy并调用该类execute()
2. 拦截器拦截用户的请求，处理请求后将请求继续发送到Action，Action执行完毕再返回到拦截器中
3. 一旦action执行完毕，请求将发送到一个result并渲染该result

#### 自定义基于类范围的拦截器
继承抽象类AbstractInterceptor
- action类
```
package com.xktj.action;

import org.apache.struts2.ServletActionContext;

import com.opensymphony.xwork2.ActionSupport;

public class LoginAction extends ActionSupport {

	private String username;
	private String pwd;
	private String msg;
	
	public String login(){
		if(username.equals("jack")&&pwd.equals("123456")){
			ServletActionContext.getRequest().getSession().setAttribute("username", username);
			return "operation";
		}else{
			msg = "用户名或密码错误！！！";
			return "login";
		}
	}
   ...
}

```
拦截器
```
package com.xktj.intercepter;

import com.opensymphony.xwork2.ActionInvocation;
import com.opensymphony.xwork2.interceptor.AbstractInterceptor;

/**
 * 类范围拦截器
 * 继承AbstractInterceptor
 */
public class ClassIntercepter extends AbstractInterceptor {

	@Override
	public String intercept(ActionInvocation invocation) throws Exception {
	
		System.out.println("访问目标对象之前执行");
		
		//将请求向下传递
		String str = invocation.invoke();
		
		System.out.println("访问目标对象之后执行");
		
		return str;
	}

}

```
xml
```
<!-- 配置自定义拦截器 -->
   	<interceptors>
   		<interceptor name="classIntercepter" class="com.xktj.intercepter.ClassIntercepter"></interceptor>
   		<interceptor name="methodIntercepter" class="com.xktj.intercepter.MethodIntercepter"></interceptor>
   	</interceptors>
   	
   	<action name="testAction_*" class="com.xktj.action.TestAction" method="{1}">
   		<!-- 注入自定义类拦截器 -->
   		<interceptor-ref name="classIntercepter"></interceptor-ref>
   		<!-- 注入默认拦截器 -->
   		<interceptor-ref name="defaultStack"></interceptor-ref>
   		<result name="show">/show.jsp</result>
   	</action>
```

### 方法拦截器


